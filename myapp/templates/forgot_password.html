{% extends 'base.html' %}

{% load static %}

{% block content %}

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>forgot password</title>
  <meta name="description"
    content="Shop the latest collection of stylish, comfortable, and affordable shoes online. Discover sneakers, formal shoes, sandals, and more with fast delivery and secure checkout." />
  <meta name="author" content="kiran k" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>

<body class="log-body">
  <div class="container d-flex justify-content-center align-items-center forg-border">
    <div class="row forg-div ">
      <!-- <div class="col-lg forg-cont"> -->
      <form id='forgot_pass'  action="" method="post">
        {% csrf_token %}
        <ul class="log-ul">
          <li>
            <p class="log-p mb-5">Forgot <span>Password</span></p>
          </li>
          <div class="d-flex align-items-end justify-content-center">
            <p class="forg-p">We will send an OTP to your Gmail address to reset your password.</p>
          </div>
          <li class="d-flex justify-content-center">
            <input type="email" id="email" name="email" placeholder="email" class="forg-inp mt-3 mb-5 " required>
          </li>
        </ul>
        <div class="d-flex justify-content-center">
        <button class="forg-button px-5 py-2" type="submit">Send OTP</button>
      </div>
      </form>
    </div>
    <!-- </div> -->
  </div>

    <!----------------------------------- modal ----------------------------------------------->


  <div class="modal fade" id="otpModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body" id="otpMessage">
        message
      </div>
    </div>
  </div>
</div>

<!----------------------------------------------------- javascript ---------------------------------------------------------->
<script>
    function getCSRF()
    {
        return document.querySelector("input[name=csrfmiddlewaretoken]").value
    }
    function showmodal(msg)
    {
      document.getElementById("otpMessage").innerText=msg
      let modal=new bootstrap.Modal(document.getElementById("otpModal"));
      modal.show();
    }
    
    document.getElementById('forgot_pass').addEventListener('submit',function(e)
    {
      e.preventDefault();
      const formdata=new FormData(this);

      fetch("",{
        method:'POST',
        headers:{
          "X-CSRFToken":getCSRF()
        },
        body:formdata,
      }).then(res => res.json())
      .then(data => {
        if(data.message == "otp sent successfully")
          window.location.href="{% url 'reset' %}"
        else
          showmodal(data.message)
      })
    })
</script>

</body>

</html>

{% endblock %}